<app-search-filters style="display: block;" [filtersForm]="filtersForm" fxHide.lt-md></app-search-filters>

  <div #resultsDummyHeader></div>

  <div *ngIf="!showEmptyState" style="margin-top: 32px;" fxLayout="row" fxLayoutAlign="left center">
    <div fxFlex>
      <p [innerHTML]="resultsSummary" style="margin-bottom: 0; margin-right: 1em;"></p>
    </div>

    <!-- Results View Switcher -->
    <div fxFlex="65px" style="display: flex; align-content: center; justify-content: center">
      <i (click)="showCardView = !showCardView" style="cursor: pointer; font-size: 36px; color: rgba(00, 40, 59, .8)" class="material-icons">{{showCardView? "view_list" : "view_module"}}</i>&nbsp;
    </div>

    <div fxFlex="100px">
      <mat-form-field floatPlaceholder="never" class="no-floating-label input-full-width">
        <mat-select placeholder="Sort By" (change)="onOrderByChange($event)" [(value)]="orderBy">
          <mat-option *ngFor="let item of sortOptions" [value]="item.id" [disabled]="searchTextIsBlank && item.name=='Relevance'">
            {{ item.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <!-- Category List -->
  <div class="category-list">
      <mat-chip-list mat-line style="height: 1.5em;">
        <span style="padding-right: 0.5em">Categories: </span>
        <mat-chip disabled *ngFor="let categoryTuple of categoryListArray" (click)="updateCategoryFromCategoryList(categoryTuple[0])" [selected]="isCurrentCategory(categoryTuple[0])">
          <span style="font-size: 14px; margin-right: 2px;" *ngFor="let categoryValue of categoryTuple; let first=first;">{{categoryValue}}<span *ngIf="first" style="padding-right: 1px">: </span></span>
        </mat-chip>
      </mat-chip-list>
    </div>

  <div *ngIf="showEmptyState" style="margin-top: 32px;">
    <p [innerHTML]="noResultsSummary"></p>
    <p>Suggestions:</p>
    <ul>
      <li fxHide.gt-md>Widen your <a (click)="openDialog()">filters</a></li>
      <li fxHide.lt-lg>Widen your filters</li>
      <li>Let us know what you were looking for via our <a [routerLink]="['/feedback']">Feedback page</a></li>
      <li>You can try the <a href="https://www.staff.auckland.ac.nz/en.html" target="_blank">Staff Service Centre</a> in the Staff Intranet</li>
    </ul>
  </div>

  <mat-nav-list *ngIf="!showCardView">
    <ng-container *ngFor="let item of resultsPage.content">
      <ng-container *ngIf="item.type !== 'policy'">
        <mat-list-item class="list-item" [routerLink]="item | listItemToRouterLink">
          <img mat-list-avatar [src]="apiService.getAssetUrl(item.image)">
          <p mat-line class="item-title">{{item.title}}</p>
          <p mat-line class="item-subtitle">{{item.subtitle}}</p>
          <mat-chip-list mat-line style="overflow: hidden;height: 18px;">
            <mat-chip disabled *ngFor="let category of item.categories" style="cursor: pointer;"><span style="color: #004059;">{{category}}</span></mat-chip>
          </mat-chip-list>
        </mat-list-item>
      </ng-container>

      <ng-container *ngIf="item.type === 'policy'">
        <a mat-list-item class="list-item" [href]="item.url" target="_blank" (click)="trackOutboundLink(item)">
          <img mat-list-avatar [src]="apiService.getAssetUrl(item.image)">
          <p mat-line class="item-title">{{item.title}}</p>
          <p mat-line class="item-subtitle">{{item.subtitle}}</p>
          <mat-chip-list mat-line style="overflow: hidden;height: 18px;">
            <mat-chip disabled *ngFor="let category of item.categories" style="margin-bottom: 2px;cursor: pointer;"><span style="color: #004059;">{{category}}</span></mat-chip>
          </mat-chip-list>
        </a>
      </ng-container>
    </ng-container>
  </mat-nav-list>

  <!--Testing Card View for Results-->
  <mat-grid-list *ngIf="showCardView" [cols]="cardViewResultsNumberOfColumns" gutterSize="1em" rowHeight="1:2" style="padding-top: 1em">
    <mat-grid-tile *ngFor="let item of resultsPage.content;" [colspan]="1" [rowspan]="1" [routerLink]="item | listItemToRouterLink" style="cursor: pointer">
      <div class="card-result-image">
        <img src="{{apiService.getAssetUrl(item.image)}}" style="width: 100%; height: 100%;"/>
      </div>
      <div class="card-result-content">
        <div class="card-result-title">
          {{item.title}}
        </div>
        <div class="card-result-subtitle">
          {{item.subtitle}}
        </div>
        <div class="card-result-chip-list">
          <mat-chip-list mat-line style="overflow: hidden; height: 1em;">
            <mat-chip disabled *ngFor="let category of item.categories" style="margin: 2px 2px 2px 0px; cursor: pointer; background-color: #fff; height: .5em">
              <span style="color: #004059;font-size: small;">{{category}}</span>
            </mat-chip>
          </mat-chip-list>
        </div>
      </div>
    </mat-grid-tile>
  </mat-grid-list>
  <!------------------------------------------------------------------------------------------>


  <mat-paginator class="search-paginator"
                 #paginator [style.visibility]="!showEmptyState ? 'visible' : 'hidden'"
                 [length]="resultsPage.totalElements"
                 [pageSize]="pageSize"
                 [pageIndex]="pageIndex"
                 [pageSizeOptions]="pageSizeOptions"
                 (page)="onPageChange($event)">
  </mat-paginator>

